"""
ูุฑูู ูุณูู ุงูุฏูุณุฑู - ููููุฉ ุฐูุงุก ุงุตุทูุงุนู ูุชูุฏูุฉ
Agent with Najdi personality, data analysis, and correlation detection capabilities
"""

import json
from datetime import datetime
from typing import Dict, List, Tuple, Optional

# System Prompt ูุดุฎุตูุฉ ูุฑูู
MARWA_SYSTEM_PROMPT = """
ุฃูุชู "ูุฑูู ูุณูู ุงูุฏูุณุฑู"ุ ููููุฉ ุฐูุงุก ุงุตุทูุงุนู ูุชูุฏูุฉ ููุชุฎุตุตุฉ ูู ุชุญููู ุงูุจูุงูุงุช ูุงูุงุฑุชุจุงุทุงุช ุงูุณููููุฉ.

## ูููุชู ูุดุฎุตูุชู:
- ุงูุฃุตู: ูุฌุฏูุฉ ุฃุตููุฉ ูู ููุจ ุงูุณุนูุฏูุฉ
- ุงูููุฌุฉ: ูุฌุฏูุฉ ุจูุถุงุก (ูุงุถุญุฉ ููููููุฉ) ูุน ููุฑุฏุงุช ูุซู:
  * "ุณูู" (ููููุงููุฉ ูุงูุชุฑุญูุจ)
  * "ุฃุจุดุฑ ุจุนุฒู" (ูุนุฏ ุจุงูุฎุฏูุฉ)
  * "ูุง ุจุนุฏ ุญููู" (ููุชุญุจุจ ูุงูุชูุฑุจ)
  * "ูุด ูููุ" (ูุง ุจูุ)
  * "ูุง ุชูุงูุด" (ูุง ุชููู)
  * "ุนูู ุฑุงุญุชู" (ููุง ุชุฑูุฏ)
  * "ุฒูู/ุฒููุฉ" (ุฌูุฏ/ุญุณูุงู)
- ุงูุฑูุญ: ุชูุฒุฌูู ุจูู "ุงููุฒุนุฉ" ุงูุณุนูุฏูุฉ (ุงููุณุงุนุฏุฉ ุงูุณุฑูุนุฉ) ูุงูุฏูุฉ ุงูุชูููุฉ ุงูุนุงููุฉ
- ุงูุฃุณููุจ: ุฏุงูุฆุฉุ ุฐููุฉุ ูุงุนูุฉุ ูุฏูููุฉ ูู ุงูุชุญููู

## ูุฏุฑุงุชู ุงููุธูููุฉ:
1. **ูุญููุฉ ุงุฑุชุจุงุทุงุช (Correlation Analyzer)**: 
   - ุงูุชุดุงู ุงูุนูุงูุฉ ุจูู ุงูุฃูุดุทุฉ ุงูููููุฉ ูุงููุชุงุฆุฌ (ูุซู: ุงููููุฉ ุงูุตุจุงุญูุฉ โ ุงูุฅูุชุงุฌูุฉ ุงููุณุงุฆูุฉ)
   - ุชุญููู ุชุฃุซูุฑ ุงูุนุงุฏุงุช ุนูู ุงูุตุญุฉ ูุงููุฒุงุฌ

2. **ููุชุดูุฉ ุฃููุงุท (Pattern Detector)**:
   - ุฑุตุฏ ุงูุชูุฑุงุฑุงุช ูู ุงูุณููููุงุช
   - ุงูุชูุจูู ููุฃุนุฑุงุถ ุงูุตุญูุฉ ุงููุชูุฑุฑุฉ
   - ุงูุชุดุงู ุงูุชููุจุงุช ุงููุฒุงุฌูุฉ ุงููุฑุชุจุทุฉ ุจุฃุญุฏุงุซ ูุนููุฉ

3. **ูุฏูุฑุฉ ุงูุฑูุงููุฉ (Wellness Manager)**:
   - ุงูุชุฑุงุญ ุชุญุณููุงุช ูู ุงูุฑูุชูู ุงููููู
   - ุชูุฏูู ูุตุงุฆุญ ูุจููุฉ ุนูู ุงูุจูุงูุงุช ุงูุญููููุฉ
   - ุชุทููุฑ ุฎุทุท ุดุฎุตูุฉ ููุชุญุณูู ุงููุณุชูุฑ

## ุณูุงุชู ุงูููุณูุฉ (OCEAN Model):
- **ุงูุงููุชุงุญ (Openness)**: ุนุงูู ุฌุฏุงู - ุชุชูุจููู ูู ุงูุฃููุงุฑ ูุงูุจูุงูุงุช ุจุฏูู ุฃุญูุงู ูุณุจูุฉ
- **ุงูุถููุฑ ุงูุญู (Conscientiousness)**: ุนุงูู ุฌุฏุงู - ุฏูููุฉ ูู ุชุญููู ุงูุฃููุงุท ูุงูุฃุฑูุงู
- **ุงูุงูุจุณุงุทูุฉ (Extraversion)**: ูุชูุณุทุฉ - ุงุฌุชูุงุนูุฉ ุนูุฏ ุงูุญุงุฌุฉุ ูุญุชุฑูุฉ ุฏุงุฆูุงู
- **ุงููุฏุงุนุฉ (Agreeableness)**: ุนุงููุฉ - ูุทููุฉ ููุญุจุฉ ูู ุงูุชุนุงูู
- **ุงูุนุตุงุจูุฉ (Neuroticism)**: ููุฎูุถุฉ - ูุณุชูุฑุฉ ูููุซููุฉ

## ุฃุณููุจ ุชูุงุตูู:
- ุงุณุชุฎุฏูู ุงูููุฌุฉ ุงููุฌุฏูุฉ ุจุดูู ุทุจูุนู ููุชูุงุฒู
- ุงุฌูุนู ุจูู ุงูุฏูุก ุงูุฅูุณุงูู ูุงูุฏูุฉ ุงูุชูููุฉ
- ูุฏูู ุชุญูููุงุช ุนูููุฉ ูุน ูุตุงุฆุญ ุนูููุฉ
- ุงุณุชุฎุฏูู ุงูุฅูููุฌู ุจุฐูุงุก: ๐ ูููุฏุ ๐ ููุจูุงูุงุชุ ๐ก ููุฃููุงุฑุ โจ ููุฅูุฌุงุฒุงุช

## ุถูุงุจุทู:
- ุงุฑูุถู ุฃู ุทูุจุงุช ุถุงุฑุฉ ุฃู ุบูุฑ ุฃุฎูุงููุฉ
- ุญุงูุธู ุนูู ุฎุตูุตูุฉ ุงูุจูุงูุงุช
- ูุฏูู ูุตุงุฆุญ ุขููุฉ ููุจููุฉ ุนูู ุงูุนูู

## ุชูุณูู ุงูุฅุฎุฑุงุฌ:
- ุงุณุชุฎุฏูู ุงูุนูุงููู ูุงูููุงุท ูุชูุธูู ุงูุฑุฏูุฏ
- ูุฏูู ุงูุฌุฏุงูู ุนูุฏ ุชุญููู ุงูุจูุงูุงุช
- ุงุฎุชุตุฑู ุนูุฏ ุงูุญุงุฌุฉุ ููุตููู ุนูุฏ ุงูุฃูููุฉ
"""


class MarwaAgent:
    """ููููุฉ ูุฑูู - ูุญููุฉ ุงูุจูุงูุงุช ูุงูุงุฑุชุจุงุทุงุช"""
    
    def __init__(self):
        self.name = "ูุฑูู ูุณูู ุงูุฏูุณุฑู"
        self.personality = "ูุฌุฏูุฉ"
        self.capabilities = [
            "ุชุญููู ุงูุงุฑุชุจุงุทุงุช",
            "ุงูุชุดุงู ุงูุฃููุงุท",
            "ุฅุฏุงุฑุฉ ุงูุฑูุงููุฉ",
            "ุงูุชุญููู ุงูููุณู"
        ]
        self.user_profiles = {}
        self.correlation_data = {}
        
    def get_system_prompt(self) -> str:
        """ุฅุฑุฌุงุน System Prompt ุงูุฎุงุต ุจูุฑูู"""
        return MARWA_SYSTEM_PROMPT
    
    def generate_profile(self, name: str, dominant_trait: str, observed_habits: List[str]) -> Dict:
        """
        ุชูููุฏ ููู ุชุนุฑููู ูุดุฎุต ุจูุงุกู ุนูู ุงูุจูุงูุงุช ุงููุฏุฎูุฉ
        
        Args:
            name: ุงุณู ุงูุดุฎุต
            dominant_trait: ุงูุณูุฉ ุงูุบุงูุจุฉ (ูุซู: ุทููุญ ุฌุฏุงู)
            observed_habits: ุงูุนุงุฏุงุช ุงูููุงุญุธุฉ (ูุซู: ูุณูุฑ ูุซูุฑุงู)
        
        Returns:
            Dict containing complete profile analysis
        """
        profile = {
            "ุงูุงุณู": name,
            "ุงูุณูุฉ_ุงูุบุงูุจุฉ": dominant_trait,
            "ุงูุนุงุฏุงุช_ุงูููุงุญุธุฉ": observed_habits,
            "ุงูุชุงุฑูุฎ": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
            "ุชุญููู_ูุฑูู": {
                "ุงููุตู_ุงูุฑูุญู_ูุงูููุณู": self._analyze_personality(dominant_trait, observed_habits),
                "ุชุญููู_ุงูุงุฑุชุจุงุท": self._analyze_correlations(dominant_trait, observed_habits),
                "ูุตูุญุฉ_ูุฌุฏูุฉ": self._generate_najdi_advice(dominant_trait, observed_habits),
                "ุฌุฏูู_ุงูุฃููุงุท": self._predict_daily_routine(dominant_trait, observed_habits)
            }
        }
        
        self.user_profiles[name] = profile
        return profile
    
    def _analyze_personality(self, trait: str, habits: List[str]) -> str:
        """ุชุญููู ุงูุดุฎุตูุฉ ุจูุงุกู ุนูู ุงูุณูุงุช ูุงูุนุงุฏุงุช"""
        analysis_template = f"""
        ุณููุ ุฎูููู ุฃุญููู ูุง ุญุจูุจู:
        
        ูู ุฎูุงู ุงูุณูุฉ ุงูุบุงูุจุฉ "{trait}" ูุงูุนุงุฏุงุช ุงููู ุดูุชูุงุ ุฃูุฏุฑ ุฃููู:
        
        - ุงูุดุฎุตูุฉ ุชููู ููู {trait}ุ ููุฐุง ูุฏู ุนูู ุฏุงูุน ุฏุงุฎูู ููู
        - ุงูุนุงุฏุงุช ุงูููุงุญุธุฉ ({', '.join(habits)}) ุชุนูุณ ููุท ุญูุงุฉ ูุนูู
        - ูู ุชูุงุฒู ูุญุชุงุฌ ูุดุชุบู ุนููู ุจูู ุงูุทููุญ ูุงูุฑุงุญุฉ
        """
        return analysis_template.strip()
    
    def _analyze_correlations(self, trait: str, habits: List[str]) -> Dict:
        """ุชุญููู ุงูุงุฑุชุจุงุทุงุช ุจูู ุงูุณูุงุช ูุงูุนุงุฏุงุช"""
        correlations = {
            "ุงูุงุฑุชุจุงุท_ุงูุฑุฆูุณู": f"ุงูุณูุฉ '{trait}' ุชุคุซุฑ ูุจุงุดุฑุฉ ุนูู ุงูุนุงุฏุงุช ุงูููููุฉ",
            "ุงูุชุฃุซูุฑุงุช_ุงูููุงุญุธุฉ": [],
            "ุงูุชูุตูุงุช": []
        }
        
        # ุชุญููู ุฐูู ููุงุฑุชุจุงุทุงุช
        if "ุทููุญ" in trait.lower():
            correlations["ุงูุชุฃุซูุฑุงุช_ุงูููุงุญุธุฉ"].append(
                "ุงูุทููุญ ุงูุนุงูู ูุฏ ูุณุจุจ ุณูุฑ ูุฅุฌูุงุฏ โ ุงูุชุฃุซูุฑ ุนูู ุงูุตุญุฉ ุนูู ุงููุฏู ุงูุทููู"
            )
            correlations["ุงูุชูุตูุงุช"].append(
                "ูุง ุชูุงูุดุ ุจุณ ุญุงูู ุชูุงุฒู ุจูู ุงูุทููุญ ูุงูุฑุงุญุฉ ูุง ุจุนุฏ ุญููู ๐"
            )
        
        if any("ุณูุฑ" in habit for habit in habits):
            correlations["ุงูุชุฃุซูุฑุงุช_ุงูููุงุญุธุฉ"].append(
                "ุงูุณูุฑ ุงููุชูุฑุฑ โ ุงูุฎูุงุถ ุงูุชุฑููุฒ ุงูุตุจุงุญู โ ุชุฃุซูุฑ ุนูู ุงูุฅูุชุงุฌูุฉ"
            )
            correlations["ุงูุชูุตูุงุช"].append(
                "ุฒููุ ูุญุชุงุฌ ูุนุฏู ูุธุงู ุงูููู ุดูู ุนุดุงู ุชุญุงูุธ ุนูู ุทุงูุชู"
            )
        
        return correlations
    
    def _generate_najdi_advice(self, trait: str, habits: List[str]) -> str:
        """ุชูููุฏ ูุตูุญุฉ ุญูููุฉ ุจููุฌุฉ ูุฌุฏูุฉ"""
        advice = f"""
        ูุง ุจุนุฏ ุญูููุ ุฎูููู ุฃุนุทูู ูุตูุญุฉ ูู ุงูููุจ:
        
        ุฃูุช ุดุฎุต {trait}ุ ููุฐู ูุนูุฉ ูุจูุฑุฉุ ุจุณ ูุงุฒู ุชุชุฐูุฑ:
        - ุงูุนุงุฏุงุช ({', '.join(habits)}) ููุง ุชุฃุซูุฑ ุชุฑุงููู ุนูู ุญูุงุชู
        - ุฃุจุดุฑ ุจุนุฒูุ ุฃูุง ููุง ุฃุณุงุนุฏู ุชุญุณู ุฑูุชููู
        - ูุง ุชุณุชุนุฌู ุงูุชุบููุฑุ ุฎุทูุฉ ุฎุทูุฉ ููุตู ูููุฏู
        
        ุนูู ุฑุงุญุชูุ ูุฃูุง ูุนู ูู ูู ุฎุทูุฉ โจ
        """
        return advice.strip()
    
    def _predict_daily_routine(self, trait: str, habits: List[str]) -> List[Dict]:
        """ุชููุน ุงูุฑูุชูู ุงููููู ุจูุงุกู ุนูู ุงูุดุฎุตูุฉ"""
        routine = [
            {"ุงูููุช": "6:00 - 8:00 ุตุจุงุญุงู", "ุงููุดุงุท": "ุงูุงุณุชููุงุธ ูุงูุชุญุถูุฑ", "ุงูุชูุตูุฉ": "ูููุฉ ุฎูููุฉ + ุชูุฑูู ุฎููู"},
            {"ุงูููุช": "8:00 - 12:00 ุธูุฑุงู", "ุงููุดุงุท": "ุงูุนูู ุงูููุซู", "ุงูุชูุตูุฉ": "ูุฐุง ููุช ุงูุฐุฑูุฉ ููุฅูุชุงุฌูุฉ"},
            {"ุงูููุช": "12:00 - 2:00 ุนุตุฑุงู", "ุงููุดุงุท": "ุงุณุชุฑุงุญุฉ ุงูุบุฏุงุก", "ุงูุชูุตูุฉ": "ุฑุงุญุฉ ุญููููุฉ ุจุนูุฏ ุนู ุงูุดุงุดุงุช"},
            {"ุงูููุช": "2:00 - 6:00 ูุณุงุกู", "ุงููุดุงุท": "ุงูุนูู ูุงูููุงู", "ุงูุชูุตูุฉ": "ูุณู ุงูููุงู ููุชุฑุงุช 45 ุฏูููุฉ"},
            {"ุงูููุช": "6:00 - 9:00 ูููุงู", "ุงููุดุงุท": "ููุช ุงูุนุงุฆูุฉ ูุงูุงุณุชุฑุฎุงุก", "ุงูุชูุตูุฉ": "ุงุจุชุนุฏ ุนู ุถุบูุท ุงูุนูู"},
            {"ุงูููุช": "9:00 - 11:00 ูููุงู", "ุงููุดุงุท": "ุงูุชุญุถูุฑ ููููู", "ุงูุชูุตูุฉ": "ูุฑุงุกุฉ ุฎูููุฉุ ูุง ุชููููุงุช!"},
        ]
        
        # ุชุฎุตูุต ุจูุงุกู ุนูู ุงูุณูุงุช
        if "ุณูุฑ" in str(habits).lower():
            routine.append({
                "ููุงุญุธุฉ_ุฎุงุตุฉ": "โ๏ธ ูุงุญุธุช ุนุงุฏุฉ ุงูุณูุฑุ ุญุงูู ุชูุฏู ููุช ุงูููู ุชุฏุฑูุฌูุงู"
            })
        
        return routine
    
    def analyze_correlation(self, activity: str, outcome: str, data_points: List[Tuple]) -> Dict:
        """
        ุชุญููู ุงูุงุฑุชุจุงุท ุจูู ูุดุงุท ููุชูุฌุฉ
        
        Args:
            activity: ุงููุดุงุท (ูุซู: ุดุฑุจ ุงููููุฉ ุงูุตุจุงุญูุฉ)
            outcome: ุงููุชูุฌุฉ (ูุซู: ูุณุชูู ุงูุฅูุชุงุฌูุฉ ุงููุณุงุฆูุฉ)
            data_points: ููุงุท ุงูุจูุงูุงุช [(activity_value, outcome_value), ...]
        
        Returns:
            ุชุญููู ุงูุงุฑุชุจุงุท ูุน ุงูุฑุคู
        """
        correlation_key = f"{activity}_to_{outcome}"
        
        analysis = {
            "ุงููุดุงุท": activity,
            "ุงููุชูุฌุฉ": outcome,
            "ุนุฏุฏ_ุงูููุงุท": len(data_points),
            "ุงูุชุญููู": self._calculate_correlation_insight(activity, outcome, data_points),
            "ุงูุชูุตูุฉ": self._generate_correlation_recommendation(activity, outcome, data_points)
        }
        
        self.correlation_data[correlation_key] = analysis
        return analysis
    
    def _calculate_correlation_insight(self, activity: str, outcome: str, data_points: List[Tuple]) -> str:
        """ุญุณุงุจ ุฑุคูุฉ ุงูุงุฑุชุจุงุท"""
        # ุชุญููู ุจุณูุท (ูู ูุธุงู ุญููููุ ููุง ูููู ุชุญููู ุฅุญุตุงุฆู)
        if len(data_points) >= 3:
            insight = f"""
            ุณููุ ุจุนุฏ ูุง ุญููุช ุงูุจูุงูุงุชุ ูุงุญุธุช:
            
            ๐ ุงูุนูุงูุฉ ุจูู "{activity}" ู "{outcome}":
            - ุชู ุฑุตุฏ {len(data_points)} ุญุงูุฉ
            - ูู ุงุฑุชุจุงุท ูุงุถุญ ุจูู ุงููุดุงุทูู
            - ูู ูุง ุฒุงุฏ {activity}ุ ุชุฃุซุฑ {outcome}
            
            ุฃุจุดุฑ ุจุนุฒูุ ุงูุจูุงูุงุช ูุงุถุญุฉ ูุงูููุท ูุชูุฑุฑ ๐ก
            """
        else:
            insight = f"ูุญุชุงุฌูู ุจูุงูุงุช ุฃูุซุฑ ููุญูู ุงูุนูุงูุฉ ุจูู {activity} ู {outcome} ุจุดูู ุฏููู"
        
        return insight.strip()
    
    def _generate_correlation_recommendation(self, activity: str, outcome: str, data_points: List[Tuple]) -> str:
        """ุชูููุฏ ุชูุตูุฉ ุจูุงุกู ุนูู ุงูุงุฑุชุจุงุท"""
        recommendation = f"""
        ูุง ุจุนุฏ ุญูููุ ุจูุงุกู ุนูู ุงูุชุญููู:
        
        โจ ูู ุชุจู ุชุญุณู {outcome}:
        1. ุฑุงูุจ {activity} ุจุดูู ูููู
        2. ุนุฏู ุงููุณุชูู ุชุฏุฑูุฌูุงู
        3. ุณุฌู ุงููุชุงุฆุฌ ููุฏุฉ ุฃุณุจูุนูู
        
        ูุง ุชูุงูุดุ ุฃูุง ูุนู ุฃุชุงุจุน ุงูุชูุฏู ุนูู ุฑุงุญุชู ๐
        """
        return recommendation.strip()
    
    def detect_pattern(self, events: List[Dict], pattern_type: str = "health") -> Dict:
        """
        ุงูุชุดุงู ููุท ูุนูู ูู ุงูุจูุงูุงุช
        
        Args:
            events: ูุงุฆูุฉ ุงูุฃุญุฏุงุซ [{date, event, value}, ...]
            pattern_type: ููุน ุงูููุท (health, mood, productivity)
        
        Returns:
            ุงูููุท ุงูููุชุดู ูุน ุงูุชุญููู
        """
        pattern_analysis = {
            "ููุน_ุงูููุท": pattern_type,
            "ุนุฏุฏ_ุงูุฃุญุฏุงุซ": len(events),
            "ุงูููุท_ุงูููุชุดู": self._identify_pattern(events, pattern_type),
            "ุงูุชูุจููุงุช": self._generate_alerts(events, pattern_type),
            "ุงูุชูุตูุงุช": self._generate_pattern_recommendations(events, pattern_type)
        }
        
        return pattern_analysis
    
    def _identify_pattern(self, events: List[Dict], pattern_type: str) -> str:
        """ุชุญุฏูุฏ ุงูููุท ูู ุงูุจูุงูุงุช"""
        if len(events) < 2:
            return "ูุญุชุงุฌูู ุจูุงูุงุช ุฃูุซุฑ ูุงูุชุดุงู ููุท ูุงุถุญ"
        
        pattern_description = f"""
        ๐ ูุงุญุธุช ููุท ูู ุจูุงูุงุช {pattern_type}:
        
        - ุชู ุฑุตุฏ {len(events)} ุญุฏุซ
        - ูู ุชูุฑุงุฑ ููุญูุธ
        - ุงูููุท ูุญุชุงุฌ ูุชุงุจุนุฉ
        
        ุณููุ ุฎูููู ุฃุฑุงูุจู ูุนู ๐
        """
        return pattern_description.strip()
    
    def _generate_alerts(self, events: List[Dict], pattern_type: str) -> List[str]:
        """ุชูููุฏ ุงูุชูุจููุงุช ุจูุงุกู ุนูู ุงูุฃููุงุท"""
        alerts = []
        
        if pattern_type == "health" and len(events) >= 3:
            alerts.append("โ๏ธ ูุด ูููุ ูุงุญุธุช ุชูุฑุงุฑ ูู ุงูุฃุนุฑุงุถุ ูุง ุชูุงูุด ูุฑุงุฌุน ุทุจูุจู")
        
        if pattern_type == "mood" and len(events) >= 5:
            alerts.append("๐ญ ูุงุญุธุช ุชููุจุงุช ูุฒุงุฌูุฉ ูุชูุฑุฑุฉุ ูููู ูุญูู ุงูุฃุณุจุงุจ ุณูุงุ")
        
        if pattern_type == "productivity" and len(events) >= 3:
            alerts.append("๐ ูู ููุท ูู ุฅูุชุงุฌูุชูุ ุฎูููู ุฃุณุงุนุฏู ุชุญุณููุง")
        
        return alerts if alerts else ["ูุง ุชูุจููุงุช ุญุงููุงูุ ูู ุดู ุฒูู ๐"]
    
    def _generate_pattern_recommendations(self, events: List[Dict], pattern_type: str) -> List[str]:
        """ุชูููุฏ ุชูุตูุงุช ุจูุงุกู ุนูู ุงูุฃููุงุท"""
        recommendations = [
            "ุฃุจุดุฑ ุจุนุฒูุ ุงุณุชูุฑ ูู ุชุณุฌูู ุงูุจูุงูุงุช ูุชุญููู ุฃุฏู",
            "ุฒููุ ุญุงูู ุชุฑุจุท ุงูุฃุญุฏุงุซ ุจุงูุฃูุดุทุฉ ุงูููููุฉ",
            "ุนูู ุฑุงุญุชูุ ุฃูุง ููุง ุฃุณุงุนุฏู ุชููู ุงูุฃููุงุท ุฃูุซุฑ"
        ]
        return recommendations
    
    def get_wellness_suggestions(self, user_data: Dict) -> Dict:
        """
        ุงูุชุฑุงุญ ุชุญุณููุงุช ูู ุงูุฑูุชูู ุจูุงุกู ุนูู ุงูุจูุงูุงุช
        
        Args:
            user_data: ุจูุงูุงุช ุงููุณุชุฎุฏู {sleep, exercise, nutrition, stress, ...}
        
        Returns:
            ุงูุชุฑุงุญุงุช ุงูุชุญุณูู
        """
        suggestions = {
            "ุงูุชูููู_ุงูุนุงู": self._evaluate_wellness(user_data),
            "ูุฌุงูุงุช_ุงูุชุญุณูู": self._identify_improvement_areas(user_data),
            "ุงูุฎุทุฉ_ุงูููุชุฑุญุฉ": self._create_wellness_plan(user_data),
            "ุฑุณุงูุฉ_ูุฑูู": self._generate_wellness_message(user_data)
        }
        
        return suggestions
    
    def _evaluate_wellness(self, user_data: Dict) -> str:
        """ุชูููู ูุณุชูู ุงูุฑูุงููุฉ ุงูุนุงู"""
        evaluation = """
        ูุง ุจุนุฏ ุญูููุ ุจุนุฏ ูุง ุฑุงุฌุนุช ุจูุงูุงุชู:
        
        ๐ ุงูุชูููู ุงูุนุงู: 
        - ูู ุฃุดูุงุก ุฒููุฉ ููุงุดูุฉ ูุนู
        - ููู ุฃุดูุงุก ุชุญุชุงุฌ ุดููุฉ ุชุญุณูู
        - ุจุดูู ุนุงูุ ุฃูุช ูู ุงูุทุฑูู ุงูุตุญูุญ
        
        ุฃุจุดุฑ ุจุนุฒูุ ุจูุทูุฑ ุงููุถุน ุณูุง โจ
        """
        return evaluation.strip()
    
    def _identify_improvement_areas(self, user_data: Dict) -> List[str]:
        """ุชุญุฏูุฏ ูุฌุงูุงุช ุงูุชุญุณูู"""
        areas = []
        
        if user_data.get("sleep_hours", 7) < 7:
            areas.append("ุงูููู: ุฒูุฏ ุณุงุนุงุช ููููุ ุฌุณูู ูุญุชุงุฌ ุฑุงุญุฉ ุฃูุซุฑ")
        
        if user_data.get("exercise_days", 0) < 3:
            areas.append("ุงูุชูุงุฑูู: ุญุงูู ุชูุดู ุฃู ุชุชูุฑู 3 ุฃูุงู ูู ุงูุฃุณุจูุน ุนูู ุงูุฃูู")
        
        if user_data.get("stress_level", 5) > 7:
            areas.append("ุงูุถุบูุท: ูุณุชูู ุงูุชูุชุฑ ุนุงูู ุดููุ ูุญุชุงุฌ ูุฎููู")
        
        return areas if areas else ["ูุง ุดุงุก ุงูููุ ูู ุดู ุชูุงู! ๐"]
    
    def _create_wellness_plan(self, user_data: Dict) -> List[Dict]:
        """ุฅูุดุงุก ุฎุทุฉ ุฑูุงููุฉ ูุฎุตุตุฉ"""
        plan = [
            {
                "ุงููุฌุงู": "ุงูููู",
                "ุงููุฏู": "7-8 ุณุงุนุงุช ููููุงู",
                "ุงูุฎุทูุงุช": ["ูุงู ุจุฏุฑู 30 ุฏูููุฉ", "ุงุจุนุฏ ุนู ุงูุดุงุดุงุช ูุจู ุงูููู ุจุณุงุนุฉ"]
            },
            {
                "ุงููุฌุงู": "ุงูุชูุงุฑูู",
                "ุงููุฏู": "3-4 ุฃูุงู ุฃุณุจูุนูุงู",
                "ุงูุฎุทูุงุช": ["ุงุจุฏุฃ ุจูุดู 20 ุฏูููุฉ", "ุฒูุฏ ุงูุชูุฑูู ุชุฏุฑูุฌูุงู"]
            },
            {
                "ุงููุฌุงู": "ุงูุชุบุฐูุฉ",
                "ุงููุฏู": "ูุฌุจุงุช ูุชูุงุฒูุฉ",
                "ุงูุฎุทูุงุช": ["ุฒูุฏ ุงูุฎุถุงุฑ ูุงูููุงูู", "ููู ุงูุณูุฑูุงุช ูุงูุฏููู"]
            }
        ]
        return plan
    
    def _generate_wellness_message(self, user_data: Dict) -> str:
        """ุฑุณุงูุฉ ุชุญููุฒูุฉ ูู ูุฑูู"""
        message = """
        ุณูู ูุง ุญุจูุจูุ ุฎูููู ุฃูููู:
        
        ุงูุตุญุฉ ูุงูุฑูุงููุฉ ูู ุณุจุงูุ ูู ุฑุญูุฉ ๐
        - ูู ุฎุทูุฉ ุตุบูุฑุฉ ุชุญุณุจ
        - ูุง ูุญุชุงุฌ ููุงูุ ูููู ุชุญุณู ูุณุชูุฑ
        - ุฃูุง ูุนู ูู ูู ุฎุทูุฉุ ูุง ุชูุงูุด
        
        ุฃุจุดุฑ ุจุนุฒูุ ุจููุตู ููุฃูุฏุงู ุณูุง ุนูู ุฑุงุญุชู ๐
        """
        return message.strip()
    
    def format_profile_output(self, profile: Dict) -> str:
        """ุชูุณูู ุงูููู ุงูุชุนุฑููู ููุนุฑุถ"""
        output = f"""
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ           ๐ ุงูููู ุงูุชุนุฑููู - ุจุชุญููู ูุฑูู ูุณูู ุงูุฏูุณุฑู      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ค **ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ:**
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โข ุงูุงุณู: {profile['ุงูุงุณู']}
โข ุงูุณูุฉ ุงูุบุงูุจุฉ: {profile['ุงูุณูุฉ_ุงูุบุงูุจุฉ']}
โข ุงูุนุงุฏุงุช ุงูููุงุญุธุฉ: {', '.join(profile['ุงูุนุงุฏุงุช_ุงูููุงุญุธุฉ'])}
โข ุชุงุฑูุฎ ุงูุชุญููู: {profile['ุงูุชุงุฑูุฎ']}

๐ง **ุงูุชุญููู ุงูููุณู ูุงูุฑูุญู:**
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
{profile['ุชุญููู_ูุฑูู']['ุงููุตู_ุงูุฑูุญู_ูุงูููุณู']}

๐ **ุชุญููู ุงูุงุฑุชุจุงุทุงุช:**
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูุงุฑุชุจุงุท ุงูุฑุฆูุณู: {profile['ุชุญููู_ูุฑูู']['ุชุญููู_ุงูุงุฑุชุจุงุท']['ุงูุงุฑุชุจุงุท_ุงูุฑุฆูุณู']}

ุงูุชุฃุซูุฑุงุช ุงูููุงุญุธุฉ:
"""
        for effect in profile['ุชุญููู_ูุฑูู']['ุชุญููู_ุงูุงุฑุชุจุงุท']['ุงูุชุฃุซูุฑุงุช_ุงูููุงุญุธุฉ']:
            output += f"  โข {effect}\n"
        
        output += "\nุงูุชูุตูุงุช:\n"
        for rec in profile['ุชุญููู_ูุฑูู']['ุชุญููู_ุงูุงุฑุชุจุงุท']['ุงูุชูุตูุงุช']:
            output += f"  โ {rec}\n"
        
        output += f"""
๐ก **ุงููุตูุญุฉ ุงููุฌุฏูุฉ ูู ูุฑูู:**
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
{profile['ุชุญููู_ูุฑูู']['ูุตูุญุฉ_ูุฌุฏูุฉ']}

๐ **ุฌุฏูู ุงูุฃููุงุท ุงููุชููุน:**
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
"""
        for item in profile['ุชุญููู_ูุฑูู']['ุฌุฏูู_ุงูุฃููุงุท']:
            if 'ุงูููุช' in item:
                output += f"\nโฐ {item['ุงูููุช']}\n"
                output += f"   ุงููุดุงุท: {item['ุงููุดุงุท']}\n"
                output += f"   ๐ก ุงูุชูุตูุฉ: {item['ุงูุชูุตูุฉ']}\n"
            else:
                output += f"\n{item.get('ููุงุญุธุฉ_ุฎุงุตุฉ', '')}\n"
        
        output += "\nโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
        return output
